package com.chat.videocall.user;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class IceConfigController {

    @Value("${stun.server.url}")
    private String STUN;

    @Value("${turn.server.url}")
    private String TURN;

    @Value("${turn.server.username}")
    private String USERNAME;

    @Value("${turn.server.password}")
    private String PASSWORD;

    @GetMapping("/api/iceConfig")
    public Map<String, Object> getIceConfig() {
        Map<String, Object> iceConfig = new HashMap<>();
        List<Map<String, String>> iceServers = new ArrayList<>();

        // Dodavanje STUN servera
        Map<String, String> stun = new HashMap<>();
        stun.put("urls", STUN);
        iceServers.add(stun);

        // Dodavanje TURN servera
        Map<String, String> turn = new HashMap<>();
        turn.put("urls", TURN);
        turn.put("username", USERNAME);
        turn.put("credential", PASSWORD);
        iceServers.add(turn);

        iceConfig.put("iceServers", iceServers);
        return iceConfig;
    }
}
